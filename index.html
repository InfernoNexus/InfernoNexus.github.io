<!DOCTYPE html>  <html>    <head>    
<meta name="viewport" content="width=device-width, initial-scale=1.0">    
<title>Newton & Gravity</title>    
<style>    
body { margin: 0; text-align: center; font-family: Arial; background: #b0e2ff; }
canvas { display: block; margin: auto; background: #87ceeb; border: 4px solid #000; border-radius: 32px; width: 95%; max-width: 520px; }

/* Keeping your current stacked positioning */
#controls {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-top: 15px;
}

/* Circular 3D Buttons */
#leftBtn, #rightBtn {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    border: 3px solid #ffe066; /* Golden edge */
    background: radial-gradient(circle at 30% 30%, #ff6b6b, #800000 80%); /* 3D Sphere shading */
    color: white;
    font-size: 30px;
    font-weight: bold;
    cursor: pointer;
    position: relative;
    /* This creates the heavy 3D base and the initial glow */
    box-shadow: 
        0 6px 0 #550000, 
        0 0 20px rgba(255, 215, 0, 0.9); 
    display: flex; align-items: center; justify-content: center;
    outline: none;
    -webkit-tap-highlight-color: transparent;
    transition: transform 0.1s;
}

/* The Intense Golden Aura (The Ring) */
#leftBtn::before, #rightBtn::before {
    content: '';
    position: absolute;
    top: -8px; left: -8px; right: -8px; bottom: -8px; /* Larger than button */
    border-radius: 50%;
    border: 4px solid #ffd700;
    /* Layered glow: inner glow, outer glow, and a blur */
    box-shadow: 
        0 0 15px #ffcc00, 
        inset 0 0 10px #ffcc00;
    animation: aura-glow 1.5s infinite ease-in-out;
    pointer-events: none;
}

@keyframes aura-glow {
    0% { transform: scale(1); opacity: 0.6; filter: blur(1px); }
    50% { transform: scale(1.1); opacity: 1; filter: blur(2px); }
    100% { transform: scale(1); opacity: 0.6; filter: blur(1px); }
}

/* Restart Button */
.restart-btn {
    margin-top: 15px;
    font-size: 20px;
    font-weight: bold;
    padding: 12px 30px;
    border-radius: 12px;
    border: 3px solid #ffe066;
    background: linear-gradient(#ff4d4d, #990000);
    color: white;
    box-shadow: 0 5px #550000, 0 0 20px rgba(255, 215, 0, 0.6);
    cursor: pointer;
}

#leftBtn:active, #rightBtn:active, .restart-btn:active {
    transform: translateY(4px);
    box-shadow: 0 2px #330000;
}

</style>

</head>    
<body>  <h2>üçé Newton & Gravity üçé</h2>    
<canvas id="game" width="520" height="620"></canvas>  <div id="mobile-ui">    
  <div id="controls">    
    <button id="leftBtn">‚óÄ</button>    
    <button id="rightBtn">‚ñ∂</button>    
  </div>    
  <button class="restart-btn" onclick="restartGame()">Restart Game</button>    
</div>  <audio id="bgm" loop>    
  <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_0f7c38a88e.mp3?filename=peaceful-garden-12257.mp3">    
</audio>  <script>    
let bombs = [];
let bombImg = new Image();
bombImg.src = 'bomb.png';
let windTime = 0;
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const music = document.getElementById("bgm");

// ---------------- VARIABLES ----------------
let newtonX = 215;
let appleX = Math.random() * 480;
let appleY = 0;
let score = 0;
let speed = 5;
let lives = 1;
let gameOver = false;
let isGolden = false;

const keys = { left: false, right: false };

let clouds = [
    { x: 50, y: 80, speed: 0.3 },
    { x: 250, y: 120, speed: 0.2 },
    { x: 400, y: 60, speed: 0.25 }
];

// ---------------- TEXTURES ----------------
const barkTexture = document.createElement("canvas");
barkTexture.width = 45; barkTexture.height = 220;
const barkCtx = barkTexture.getContext("2d");
barkCtx.fillStyle = "#6d4c41";
barkCtx.fillRect(0,0,45,220);

const grassTexture = document.createElement("canvas");
grassTexture.width = 520; grassTexture.height = 180;
const grassCtx = grassTexture.getContext("2d");
const g = grassCtx.createLinearGradient(0,0,0,180);
g.addColorStop(0,"#4caf50"); g.addColorStop(1,"#2e7d32");
grassCtx.fillStyle = g;
grassCtx.fillRect(0,0,520,180);

// ---------------- CONTROLS ----------------
window.addEventListener("keydown", (e) => {
    if (e.key === "ArrowLeft") keys.left = true;
    if (e.key === "ArrowRight") keys.right = true;
});
window.addEventListener("keyup", (e) => {
    if (e.key === "ArrowLeft") keys.left = false;
    if (e.key === "ArrowRight") keys.right = false;
});

const leftBtn = document.getElementById("leftBtn");
const rightBtn = document.getElementById("rightBtn");

leftBtn.addEventListener("touchstart", (e) => { e.preventDefault(); keys.left = true; });
leftBtn.addEventListener("touchend", (e) => { e.preventDefault(); keys.left = false; });
rightBtn.addEventListener("touchstart", (e) => { e.preventDefault(); keys.right = true; });
rightBtn.addEventListener("touchend", (e) => { e.preventDefault(); keys.right = false; });

// ---------------- DRAW FUNCTIONS ----------------
function drawGrass(){ ctx.drawImage(grassTexture,0,440); }

function drawClouds(){
    ctx.fillStyle="rgba(255,255,255,0.9)";
    clouds.forEach(c=>{
        ctx.beginPath();
        ctx.arc(c.x,c.y,20,0,Math.PI*2);
        ctx.arc(c.x+25,c.y+5,25,0,Math.PI*2);
        ctx.arc(c.x+55,c.y,20,0,Math.PI*2);
        ctx.fill();
        c.x+=c.speed; if(c.x>canvas.width+60) c.x=-60;
    });
}

function drawBackground(){
    ctx.drawImage(barkTexture, 90, 260);
    const sway = Math.sin(windTime) * 5;
    ctx.save();
    ctx.translate(sway, 0);
    const leafGrad = ctx.createRadialGradient(112,220,30,112,240,100);
    leafGrad.addColorStop(0,"#81c784");
    leafGrad.addColorStop(1,"#1b5e20");
    ctx.fillStyle = leafGrad;
    ctx.beginPath(); ctx.arc(112,230,80,0,Math.PI*2); ctx.fill();
    ctx.beginPath(); ctx.arc(150,250,70,0,Math.PI*2); ctx.fill();
    ctx.beginPath(); ctx.arc(70,250,70,0,Math.PI*2); ctx.fill();
    ctx.restore(); 
}

function drawNewton(){
    ctx.fillStyle="rgba(0,0,0,0.25)";
    ctx.beginPath(); ctx.ellipse(newtonX+50,565,42,10,0,0,Math.PI*2); ctx.fill();
    ctx.fillStyle="#6b3f2a"; ctx.fillRect(newtonX,455,100,95);
    ctx.fillStyle="#ffffff"; ctx.fillRect(newtonX+40,455,20,70);
    ctx.beginPath(); ctx.arc(newtonX+50,420,26,0,Math.PI*2); ctx.fillStyle="#f1c27d"; ctx.fill();
    ctx.fillStyle="#f0f0f0"; ctx.beginPath(); ctx.arc(newtonX+50,410,32,Math.PI,0); ctx.fill();
    ctx.beginPath(); ctx.arc(newtonX+18,425,14,0,Math.PI*2); ctx.arc(newtonX+82,425,14,0,Math.PI*2); ctx.fill();
    ctx.fillStyle="black"; ctx.beginPath(); ctx.arc(newtonX+42,420,2.5,0,Math.PI*2); ctx.arc(newtonX+58,420,2.5,0,Math.PI*2); ctx.fill();
    ctx.fillStyle="#000"; ctx.fillRect(newtonX+28,550,16,45); ctx.fillRect(newtonX+56,550,16,45);
}

function drawApple(){
    const appleGrad = ctx.createRadialGradient(appleX-4,appleY-6,2,appleX,appleY,16);
    appleGrad.addColorStop(0,isGolden?"#fff7b3":"#ff6b6b");
    appleGrad.addColorStop(1,isGolden?"#d4af37":"#b71c1c");
    ctx.fillStyle=appleGrad;
    ctx.beginPath(); ctx.arc(appleX,appleY,15,0,Math.PI*2); ctx.fill();
}

function spawnBomb() {
    if (Math.random() < 0.02) { // Reduced spawn rate for fairness
        bombs.push({
            x: Math.random() * (canvas.width - 40),
            y: -50,
            size: 40,
            speed: 3 + Math.random() * 2
        });
    }
}

function updateBombs() {
    for (let i = bombs.length - 1; i >= 0; i--) {
        let b = bombs[i];
        b.y += b.speed;
        ctx.drawImage(bombImg, b.x, b.y, b.size, b.size);

        if (b.x < newtonX + 100 && b.x + b.size > newtonX &&
            b.y < 455 + 95 && b.y + b.size > 455) {
            gameOver = true;
            music.pause();
        }
        if (b.y > canvas.height) bombs.splice(i, 1);
    }
}

// ---------------- GAME LOGIC ----------------
function resetApple(){
    appleY=-20;
    appleX = 30 + Math.random() * (canvas.width - 60);
    isGolden=Math.random()<0.2;
}

function restartGame(){
    score=0; speed=5; lives=1; gameOver=false;
    bombs = []; // FIXED SYNTAX
    resetApple();
    music.currentTime = 0;
    music.volume=0.5; music.play();
    gameLoop();
}

function gameLoop(){
    if(gameOver){
        ctx.fillStyle="rgba(0,0,0,0.65)"; ctx.fillRect(0,0,canvas.width,canvas.height);
        ctx.fillStyle="red"; ctx.font="38px Arial"; ctx.fillText("GAME OVER",150,300);
        ctx.fillStyle="white"; ctx.font="20px Arial"; ctx.fillText("Score: "+score,215,340);
        return;
    }

    ctx.clearRect(0,0,canvas.width,canvas.height);
    
    drawClouds(); 
    drawBackground(); 
    drawGrass(); 
    drawNewton(); 
    drawApple();
    
    // Process Bombs after clearing screen
    spawnBomb();
    updateBombs();

    if (keys.left && newtonX > 0) newtonX -= 7;
    if (keys.right && newtonX < canvas.width - 100) newtonX += 7;

    ctx.fillStyle="black"; ctx.font="18px Arial";
    ctx.fillText("Score: "+score,20,30);

    appleY+=speed;
    if(appleY>440 && appleX>newtonX && appleX<newtonX+100){
        score+=isGolden?5:1;
        if(score % 10 === 0) speed += 1;
        resetApple();
    }
    if(appleY > canvas.height){ gameOver=true; music.pause(); }
    windTime += 0.03;
    requestAnimationFrame(gameLoop);
}

// ---------------- START ----------------
resetApple();
gameLoop();

</script>  </body>

</html>  